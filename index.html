<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>ESCRITY - Guardião de Histórias</title>
    <link rel="stylesheet" href="style.css">
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Crimson+Pro:wght@300;400;500;600;700;800&family=Inter:wght@300;400;500;600;700&display=swap">
    <meta name="theme-color" content="#1a1a2e">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="ESCRITY">
    <link rel="apple-touch-icon" href="icons/icon-192x192.png">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="msapplication-TileColor" content="#1a1a2e">
    <meta name="msapplication-TileImage" content="icons/icon-144x144.png">
    <style>
        * {
            -webkit-tap-highlight-color: transparent;
            -webkit-touch-callout: none;
        }
        input, textarea, [contenteditable] {
            -webkit-user-select: text !important;
            user-select: text !important;
        }
    </style>
</head>
<body>
    <!-- Loading screen atmosférico -->
    <div id="loadingScreen" class="loading-screen">
        <div class="loading-content">
            <div class="spinner">
                <div class="pen-tip"></div>
            </div>
            <h2>ESCRITY</h2>
            <p class="loading-subtitle">Inicializando seu espaço de criação...</p>
            <div class="loading-quote">
                <i>"Cada palavra é uma semente, cada página um jardim"</i>
            </div>
        </div>
    </div>

    <div id="app-container" class="app-container" style="display: none;">
        <!-- Sidebar principal -->
        <aside class="sidebar" id="mainSidebar">
            <div class="sidebar-header">
                <div class="user-info" id="userInfo">
                    <div class="user-avatar">
                        <i class="fas fa-feather-alt"></i>
                    </div>
                    <div class="user-details">
                        <span class="username" id="currentUsername">Escritor Local</span>
                        <span class="user-status" id="syncStatus">
                            <i class="fas fa-lock"></i> Privado & Seguro
                        </span>
                    </div>
                </div>
                <button id="clearDataBtn" class="btn-logout" title="Limpar tudo">
                    <i class="fas fa-broom"></i>
                </button>
            </div>
            
            <div class="sidebar-content">
                <div class="section-title">
                    <h2><i class="fas fa-book-sparkles"></i> Cadernos</h2>
                    <button id="newNotebook" class="btn-icon" title="Novo Caderno">
                        <i class="fas fa-plus"></i>
                    </button>
                </div>
                
                <div class="notebooks-list" id="notebooksList">
                    <!-- Cadernos serão carregados aqui -->
                </div>
                
                <!-- Folhas dentro do caderno selecionado -->
                <div class="sheets-section" id="sheetsSection" style="display: none;">
                    <div class="section-title">
                        <h2><i class="fas fa-layer-group"></i> Folhas</h2>
                        <button id="newSheet" class="btn-icon" title="Nova Folha">
                            <i class="fas fa-plus"></i>
                        </button>
                    </div>
                    <div class="sheets-list-compact" id="sheetsList">
                        <!-- Folhas serão carregadas aqui -->
                    </div>
                </div>
                
                <div class="sidebar-actions">
                    <button id="backupBtn" class="btn-action">
                        <i class="fas fa-box-archive"></i> Backup
                    </button>
                    <button id="restoreBtn" class="btn-action">
                        <i class="fas fa-history"></i> Restaurar
                    </button>
                </div>
                
                <div class="sidebar-footer">
                    <button id="toggleMusic" class="btn-music">
                        <i class="fas fa-headphones"></i> Atmosfera
                    </button>
                    <button id="installBtn" class="btn-install">
                        <i class="fas fa-download"></i> Instalar
                    </button>
                </div>
            </div>
        </aside>

        <!-- Overlay mobile -->
        <div id="mobileOverlay" class="mobile-overlay"></div>

        <!-- Botão menu mobile -->
        <button id="mobileMenuBtn" class="mobile-menu-btn">
            <i class="fas fa-bars"></i>
        </button>

        <!-- Área principal -->
        <main class="main-area">
            <!-- Área de edição -->
            <div class="editor-area">
                <div class="editor-header">
                    <div class="notebook-info">
                        <div class="cover-container">
                            <img id="currentCover" src="assets/capas/default.jpg" alt="Capa">
                            <button id="changeCoverBtn" class="btn-cover" title="Mudar capa">
                                <i class="fas fa-palette"></i>
                            </button>
                        </div>
                        <div class="notebook-details">
                            <h2 id="currentNotebookTitle">Selecione um caderno</h2>
                            <div class="notebook-meta">
                                <span id="currentSheetTitle">Nenhuma folha selecionada</span>
                                <span class="sheet-date" id="sheetDate"></span>
                            </div>
                            <div class="editor-controls">
                                <div class="color-picker-container">
                                    <input type="color" id="textColorPicker" value="#2c3e50" title="Cor do texto">
                                    <label for="textColorPicker" class="color-picker-label">
                                        <i class="fas fa-fill-drip"></i>
                                    </label>
                                </div>
                                <button id="customizeSheetBtn" class="btn-customize" title="Personalizar ambiente">
                                    <i class="fas fa-magic"></i> Ambiente
                                </button>
                                <button id="fontSettingsBtn" class="btn-customize" title="Configurar escrita">
                                    <i class="fas fa-pen-nib"></i> Escrita
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="editor-tools">
                        <div class="formatting-tools">
                            <div class="tool-group">
                                <button id="paragraphBtn" title="Parágrafo"><i class="fas fa-paragraph"></i></button>
                                <button id="boldBtn" title="Negrito"><i class="fas fa-bold"></i></button>
                                <button id="italicBtn" title="Itálico"><i class="fas fa-italic"></i></button>
                                <button id="underlineBtn" title="Sublinhado"><i class="fas fa-underline"></i></button>
                                <button id="highlightBtn" title="Destacar" class="highlight-btn">
                                    <i class="fas fa-highlighter"></i>
                                </button>
                            </div>
                            <div class="tool-group">
                                <button id="listUlBtn" title="Lista"><i class="fas fa-list"></i></button>
                                <button id="imageBtn" title="Inserir imagem"><i class="fas fa-image"></i></button>
                                <button id="quoteBtn" title="Citação"><i class="fas fa-quote-right"></i></button>
                                <button id="dividerBtn" title="Divisor"><i class="fas fa-minus"></i></button>
                                <button id="saveBtn" class="btn-save">
                                    <i class="fas fa-save"></i> <span class="save-text">Guardar</span>
                                </button>
                            </div>
                        </div>
                        <div class="action-tools">
                            <div class="word-counter">
                                <i class="fas fa-font"></i>
                                <span id="wordCount">0</span>
                                <span class="counter-label">palavras</span>
                            </div>
                            <button id="exportBtn" class="btn-export" title="Exportar">
                                <i class="fas fa-file-export"></i>
                            </button>
                            <button id="deleteSheetBtn" class="btn-danger" title="Excluir folha">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="editor-container">
                    <div id="editor" contenteditable="true" class="editor-content" spellcheck="true">
                        <p class="placeholder">Selecione um caderno para começar a escrever...</p>
                    </div>
                </div>
                
                <div class="status-bar">
                    <div class="status-left">
                        <span class="stat-item">
                            <i class="fas fa-clock"></i>
                            <span id="lastSaved">Nunca salvo</span>
                        </span>
                        <span class="stat-item">
                            <i class="fas fa-ruler-combined"></i>
                            <span id="charCount">0 caracteres</span>
                        </span>
                    </div>
                    <div class="status-right">
                        <span id="musicStatus" class="music-status">
                            <i class="fas fa-music"></i>
                            <span id="musicStatusText">Silêncio</span>
                        </span>
                        <span class="stat-item">
                            <i class="fas fa-book"></i>
                            <span id="currentNotebookCount">0 folhas</span>
                        </span>
                    </div>
                </div>
            </div>

            <!-- Sidebar de música/atmosfera -->
            <div class="music-sidebar" id="musicSidebar">
                <div class="music-header">
                    <h3><i class="fas fa-headphones"></i> Atmosfera Sonora</h3>
                    <button id="closeMusic" class="btn-close">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                
                <div class="player-container">
                    <div class="now-playing" id="nowPlaying">
                        <div class="album-art">
                            <i class="fas fa-music"></i>
                        </div>
                        <div class="track-info">
                            <div class="track-title" id="currentTrackTitle">Nenhuma trilha</div>
                            <div class="track-artist" id="currentTrackArtist">Importe suas músicas</div>
                        </div>
                    </div>
                    
                    <div class="player-controls">
                        <button id="prevTrack" class="player-btn" title="Anterior">
                            <i class="fas fa-step-backward"></i>
                        </button>
                        <button id="playPause" class="player-btn play-btn" title="Reproduzir">
                            <i class="fas fa-play"></i>
                        </button>
                        <button id="nextTrack" class="player-btn" title="Próxima">
                            <i class="fas fa-step-forward"></i>
                        </button>
                    </div>
                    
                    <div class="progress-container">
                        <div class="progress-time">
                            <span id="currentTime">0:00</span>
                            <span id="duration">0:00</span>
                        </div>
                        <div class="progress-bar" id="progressBar">
                            <div class="progress-fill" id="progressFill"></div>
                        </div>
                    </div>
                    
                    <div class="volume-container">
                        <i class="fas fa-volume-down"></i>
                        <div class="volume-bar" id="volumeBar">
                            <div class="volume-fill" id="volumeFill"></div>
                        </div>
                        <i class="fas fa-volume-up"></i>
                    </div>
                </div>
                
                <div class="music-library">
                    <div class="library-header">
                        <h4><i class="fas fa-music"></i> Suas Músicas</h4>
                        <div class="library-info">
                            <span id="trackCount">0 músicas</span>
                            <button id="deleteAllTracks" class="btn-small" title="Limpar todas">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div class="tracks-container">
                        <div class="tracks-list" id="uploadedTracksList">
                            <!-- Músicas importadas serão carregadas aqui -->
                            <div class="empty-state" id="emptyTracksState">
                                <i class="fas fa-cloud-upload-alt"></i>
                                <p>Nenhuma música importada</p>
                                <p class="hint">Importe suas músicas para criar atmosfera</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="upload-section">
                        <div class="upload-area" id="uploadArea">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>Importar músicas</p>
                            <p class="upload-hint">Arraste ou clique para selecionar</p>
                            <input type="file" id="audioUpload" accept="audio/*" multiple hidden>
                        </div>
                        <div class="upload-info">
                            <p><i class="fas fa-info-circle"></i> Formatos suportados: MP3, WAV, OGG, M4A</p>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Modal para novo caderno -->
    <div id="notebookModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-book-medical"></i> Novo Caderno</h3>
                <p class="modal-subtitle">Dê um nome ao seu novo espaço de criação</p>
            </div>
            <div class="modal-body">
                <div class="input-with-icon">
                    <i class="fas fa-pen"></i>
                    <input type="text" id="notebookName" placeholder="Ex: Ideias para romance, Poemas, Diário..." maxlength="60" autocomplete="off">
                </div>
                <div class="color-selection">
                    <p>Cor do caderno:</p>
                    <div class="color-options">
                        <div class="color-option active" data-color="#1a1a2e" style="background: #1a1a2e;"></div>
                        <div class="color-option" data-color="#2c3e50" style="background: #2c3e50;"></div>
                        <div class="color-option" data-color="#34495e" style="background: #34495e;"></div>
                        <div class="color-option" data-color="#16a085" style="background: #16a085;"></div>
                        <div class="color-option" data-color="#27ae60" style="background: #27ae60;"></div>
                        <div class="color-option" data-color="#8e44ad" style="background: #8e44ad;"></div>
                    </div>
                </div>
            </div>
            <div class="modal-actions">
                <button id="cancelNotebookBtn" class="btn-secondary">Cancelar</button>
                <button id="createNotebookBtn" class="btn-primary">
                    <i class="fas fa-sparkles"></i> Criar Caderno
                </button>
            </div>
        </div>
    </div>

    <!-- Modal para nova folha -->
    <div id="sheetModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-file-medical"></i> Nova Folha</h3>
                <p class="modal-subtitle">Dê um título à sua nova página</p>
            </div>
            <div class="modal-body">
                <div class="input-with-icon">
                    <i class="fas fa-heading"></i>
                    <input type="text" id="sheetName" placeholder="Ex: Capítulo 1, Poema noturno, Ideia principal..." maxlength="100" autocomplete="off">
                </div>
                <div class="sheet-template">
                    <p>Modelo:</p>
                    <select id="sheetTemplate">
                        <option value="blank">Página em branco</option>
                        <option value="chapter">Capítulo de livro</option>
                        <option value="poem">Formato poético</option>
                        <option value="diary">Entrada de diário</option>
                        <option value="notes">Anotações</option>
                    </select>
                </div>
            </div>
            <div class="modal-actions">
                <button id="cancelSheetBtn" class="btn-secondary">Cancelar</button>
                <button id="createSheetBtn" class="btn-primary">
                    <i class="fas fa-magic"></i> Criar Folha
                </button>
            </div>
        </div>
    </div>

    <!-- Modal de personalização -->
    <div id="customizeSheetModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-campfire"></i> Ambiente de Escrita</h3>
                <p class="modal-subtitle">Configure a atmosfera da sua página</p>
            </div>
            <div class="modal-body">
                <div class="customization-section">
                    <h4><i class="fas fa-image"></i> Fundo da Página</h4>
                    <div class="background-grid">
                        <div class="bg-option active" data-bg="none">
                            <div class="bg-preview blank">
                                <i class="fas fa-ban"></i>
                            </div>
                            <span>Vazio</span>
                        </div>
                        <div class="bg-option" data-bg="paper">
                            <div class="bg-preview paper-texture"></div>
                            <span>Papel</span>
                        </div>
                        <div class="bg-option" data-bg="dark">
                            <div class="bg-preview dark-texture"></div>
                            <span>Noturno</span>
                        </div>
                        <div class="bg-option" data-bg="custom">
                            <div class="bg-preview custom">
                                <i class="fas fa-upload"></i>
                            </div>
                            <span>Personalizar</span>
                            <input type="file" id="bgImageUpload" accept="image/*" hidden>
                        </div>
                    </div>
                </div>
                
                <div class="customization-section">
                    <h4><i class="fas fa-tint"></i> Tom da Página</h4>
                    <div class="color-palette">
                        <div class="color-tone active" data-tone="#ffffff" style="background: #ffffff;"></div>
                        <div class="color-tone" data-tone="#f8f5e9" style="background: #f8f5e9;"></div>
                        <div class="color-tone" data-tone="#f0f0f0" style="background: #f0f0f0;"></div>
                        <div class="color-tone" data-tone="#1a1a2e" style="background: #1a1a2e;"></div>
                        <div class="color-tone" data-tone="#2d3436" style="background: #2d3436;"></div>
                        <div class="color-tone" data-tone="#fef9e7" style="background: #fef9e7;"></div>
                    </div>
                </div>
                
                <div class="customization-section">
                    <h4><i class="fas fa-border-style"></i> Margens</h4>
                    <div class="margin-options">
                        <button class="margin-option active" data-margin="wide">Largas</button>
                        <button class="margin-option" data-margin="normal">Normais</button>
                        <button class="margin-option" data-margin="narrow">Estreitas</button>
                        <button class="margin-option" data-margin="full">Cheia</button>
                    </div>
                </div>
            </div>
            <div class="modal-actions">
                <button id="cancelCustomizeBtn" class="btn-secondary">Cancelar</button>
                <button id="applyCustomizeBtn" class="btn-primary">
                    <i class="fas fa-check"></i> Aplicar Ambiente
                </button>
            </div>
        </div>
    </div>

    <!-- Modal de configurações de escrita -->
    <div id="fontSettingsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-pen-nib"></i> Configurar Escrita</h3>
                <p class="modal-subtitle">Ajuste a aparência do seu texto</p>
            </div>
            <div class="modal-body">
                <div class="font-section">
                    <h4><i class="fas fa-font"></i> Tipografia</h4>
                    <div class="font-grid">
                        <div class="font-option" data-font="'Crimson Pro', serif">
                            <div class="font-preview crimson">Aa</div>
                            <span>Crimson</span>
                        </div>
                        <div class="font-option active" data-font="'Inter', sans-serif">
                            <div class="font-preview inter">Aa</div>
                            <span>Inter</span>
                        </div>
                        <div class="font-option" data-font="'Georgia', serif">
                            <div class="font-preview georgia">Aa</div>
                            <span>Georgia</span>
                        </div>
                        <div class="font-option" data-font="'Courier New', monospace">
                            <div class="font-preview courier">Aa</div>
                            <span>Courier</span>
                        </div>
                    </div>
                </div>
                
                <div class="font-section">
                    <h4><i class="fas fa-text-height"></i> Tamanho & Espaçamento</h4>
                    <div class="slider-group">
                        <label>Tamanho: <span id="fontSizeValue">18px</span></label>
                        <input type="range" id="fontSize" min="14" max="24" step="1" value="18">
                    </div>
                    <div class="slider-group">
                        <label>Entrelinha: <span id="lineHeightValue">1.6</span></label>
                        <input type="range" id="lineHeight" min="1.2" max="2.2" step="0.1" value="1.6">
                    </div>
                </div>
                
                <div class="preview-section">
                    <h4><i class="fas fa-eye"></i> Prévia</h4>
                    <div class="font-preview-area" id="fontPreviewArea">
                        A lua banha de prata as folhas do caderno, enquanto as palavras dançam na ponta da caneta, ansiosas por ganhar vida no papel em branco.
                    </div>
                </div>
            </div>
            <div class="modal-actions">
                <button id="cancelFontBtn" class="btn-secondary">Cancelar</button>
                <button id="applyFontBtn" class="btn-primary">
                    <i class="fas fa-check"></i> Aplicar Estilo
                </button>
            </div>
        </div>
    </div>

    <!-- Modal de imagem -->
    <div id="imageModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-image"></i> Inserir Imagem</h3>
                <p class="modal-subtitle">Adicione uma imagem à sua história</p>
            </div>
            <div class="modal-body">
                <div class="image-upload-area" id="imageUploadArea">
                    <i class="fas fa-cloud-upload-alt"></i>
                    <p>Arraste uma imagem aqui ou clique para selecionar</p>
                    <input type="file" id="imageFile" accept="image/*" hidden>
                </div>
                <div class="image-preview" id="imagePreview" style="display: none;">
                    <img id="previewImage" src="" alt="Prévia">
                </div>
                <div class="image-options">
                    <div class="input-group">
                        <label for="imageAlt">Descrição:</label>
                        <input type="text" id="imageAlt" placeholder="O que esta imagem representa?">
                    </div>
                    <div class="size-options">
                        <label>Tamanho:</label>
                        <div class="size-buttons">
                            <button class="size-btn active" data-size="responsive">Automático</button>
                            <button class="size-btn" data-size="medium">Médio</button>
                            <button class="size-btn" data-size="large">Grande</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-actions">
                <button id="cancelImageBtn" class="btn-secondary">Cancelar</button>
                <button id="insertImageBtn" class="btn-primary" disabled>
                    <i class="fas fa-image"></i> Inserir Imagem
                </button>
            </div>
        </div>
    </div>

    <!-- Modal de exportação -->
    <div id="exportModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-file-export"></i> Exportar Caderno</h3>
                <p class="modal-subtitle">Salve todo o caderno em diferentes formatos</p>
            </div>
            <div class="modal-body">
                <div class="export-options">
                    <div class="export-option" data-format="pdf">
                        <i class="fas fa-file-pdf"></i>
                        <div>
                            <h4>PDF</h4>
                            <p>Formato universal para leitura</p>
                        </div>
                    </div>
                    <div class="export-option active" data-format="txt">
                        <i class="fas fa-file-alt"></i>
                        <div>
                            <h4>Texto Simples</h4>
                            <p>Compatível com qualquer editor</p>
                        </div>
                    </div>
                    <div class="export-option" data-format="html">
                        <i class="fas fa-code"></i>
                        <div>
                            <h4>HTML</h4>
                            <p>Preserva formatação e imagens</p>
                        </div>
                    </div>
                </div>
                <div class="export-settings">
                    <label>
                        <input type="checkbox" id="includeMetadata" checked>
                        Incluir metadados (data, título, contagem)
                    </label>
                </div>
            </div>
            <div class="modal-actions">
                <button id="cancelExportBtn" class="btn-secondary">Cancelar</button>
                <button id="confirmExportBtn" class="btn-primary">
                    <i class="fas fa-download"></i> Exportar Caderno
                </button>
            </div>
        </div>
    </div>

    <!-- Modal de capa -->
    <div id="coverModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-palette"></i> Capa do Caderno</h3>
                <p class="modal-subtitle">Personalize a aparência do seu caderno</p>
            </div>
            <div class="modal-body">
                <div class="cover-presets">
                    <div class="cover-preset active" data-cover="default">
                        <div class="cover-preview default">
                            <i class="fas fa-book"></i>
                        </div>
                        <span>Padrão</span>
                    </div>
                    <div class="cover-preset" data-cover="leather">
                        <div class="cover-preview leather"></div>
                        <span>Couro</span>
                    </div>
                    <div class="cover-preset" data-cover="fabric">
                        <div class="cover-preview fabric"></div>
                        <span>Tecido</span>
                    </div>
                    <div class="cover-preset" data-cover="custom">
                        <div class="cover-preview custom">
                            <i class="fas fa-upload"></i>
                        </div>
                        <span>Personalizar</span>
                    </div>
                </div>
                
                <div class="custom-cover-upload" id="customCoverUpload" style="display: none;">
                    <div class="upload-cover-area" id="coverUploadArea">
                        <i class="fas fa-cloud-upload-alt"></i>
                        <p>Escolha uma imagem para a capa</p>
                        <input type="file" id="coverFile" accept="image/*" hidden>
                    </div>
                </div>
            </div>
            <div class="modal-actions">
                <button id="cancelCoverBtn" class="btn-secondary">Cancelar</button>
                <button id="applyCoverBtn" class="btn-primary">
                    <i class="fas fa-check"></i> Aplicar Capa
                </button>
            </div>
        </div>
    </div>

    <!-- Modal de backup -->
    <div id="backupModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-box-archive"></i> Sistema de Backup</h3>
                <p class="modal-subtitle">Proteja suas histórias com cópias de segurança</p>
            </div>
            <div class="modal-body">
                <div class="backup-options">
                    <div class="backup-option" data-action="create">
                        <i class="fas fa-save"></i>
                        <div>
                            <h4>Criar Backup</h4>
                            <p>Salve uma cópia de segurança agora</p>
                        </div>
                    </div>
                    <div class="backup-option" data-action="restore">
                        <i class="fas fa-history"></i>
                        <div>
                            <h4>Restaurar</h4>
                            <p>Recupere de um backup anterior</p>
                        </div>
                    </div>
                    <div class="backup-option" data-action="manage">
                        <i class="fas fa-folder-open"></i>
                        <div>
                            <h4>Gerenciar</h4>
                            <p>Veja e organize seus backups</p>
                        </div>
                    </div>
                </div>
                
                <div class="backup-info" id="backupInfo">
                    <p><i class="fas fa-info-circle"></i> Backups são salvos automaticamente a cada 24 horas</p>
                    <p><i class="fas fa-shield-alt"></i> Seus dados permanecem apenas neste dispositivo</p>
                </div>
            </div>
            <div class="modal-actions">
                <button id="cancelBackupBtn" class="btn-secondary">Fechar</button>
            </div>
        </div>
    </div>

    <!-- Modal de restauração -->
    <div id="restoreModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-history"></i> Restaurar Backup</h3>
                <p class="modal-subtitle">Selecione um backup para restaurar</p>
            </div>
            <div class="modal-body">
                <div class="backups-list" id="backupsList">
                    <!-- Backups serão listados aqui -->
                    <div class="empty-state">
                        <i class="fas fa-history"></i>
                        <p>Nenhum backup encontrado</p>
                    </div>
                </div>
                <div class="restore-warning">
                    <p><i class="fas fa-exclamation-triangle"></i> A restauração substituirá todos os dados atuais</p>
                </div>
            </div>
            <div class="modal-actions">
                <button id="cancelRestoreBtn" class="btn-secondary">Cancelar</button>
                <button id="confirmRestoreBtn" class="btn-primary" disabled>
                    <i class="fas fa-history"></i> Restaurar
                </button>
            </div>
        </div>
    </div>

    <!-- Modal de confirmação -->
    <div id="confirmModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-exclamation-circle"></i> Confirmação</h3>
            </div>
            <div class="modal-body">
                <p id="confirmMessage">Tem certeza que deseja realizar esta ação?</p>
            </div>
            <div class="modal-actions">
                <button id="cancelConfirmBtn" class="btn-secondary">Cancelar</button>
                <button id="confirmActionBtn" class="btn-danger">Confirmar</button>
            </div>
        </div>
    </div>

    <!-- Notificação -->
    <div id="notification" class="notification">
        <div class="notification-content">
            <i class="fas fa-check-circle"></i>
            <div class="notification-text">
                <strong id="notificationTitle">Sucesso!</strong>
                <span id="notificationText">Ação realizada com sucesso</span>
            </div>
        </div>
    </div>

    <!-- Audio player -->
    <audio id="audioPlayer" hidden></audio>

    <script src="script.js"></script>
    <script>
    // Configurações de Service Worker
    if ('serviceWorker' in navigator) {
        window.addEventListener('load', function() {
            navigator.serviceWorker.register('sw.js')
                .then(function(registration) {
                    console.log('ESCRITY: Service Worker registrado');
                    
                    // Verificar atualizações
                    registration.addEventListener('updatefound', () => {
                        const newWorker = registration.installing;
                        
                        newWorker.addEventListener('statechange', () => {
                            if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                console.log('ESCRITY: Nova versão disponível');
                            }
                        });
                    });
                })
                .catch(function(err) {
                    console.log('ESCRITY: Service Worker não registrado:', err);
                });
        });
    }
    
    // Ajuste de altura mobile
    function fixMobileHeight() {
        const vh = window.innerHeight * 0.01;
        document.documentElement.style.setProperty('--vh', `${vh}px`);
    }
    
    window.addEventListener('resize', fixMobileHeight);
    window.addEventListener('orientationchange', fixMobileHeight);
    fixMobileHeight();
    
    // Prevenir zoom duplo toque
    let lastTouchEnd = 0;
    document.addEventListener('touchend', function (event) {
        const now = Date.now();
        if (now - lastTouchEnd <= 300) {
            event.preventDefault();
        }
        lastTouchEnd = now;
    }, false);
    
    // Prevenir gestos de zoom
    document.addEventListener('gesturestart', function (e) {
        e.preventDefault();
    });
    </script>
</body>
</html>